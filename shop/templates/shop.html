{% extends 'layouts/base.html' %}

{% block css %}

{% endblock %}

{% block content %}

<div class="container">
    <div class="row mt-5 justify-content-center text-center">
        <div class="col-lg-10">
            <h2 class="mb-3">Search for products </h2>
            <form action="{% url 'searchProducts' %}" method="post">
                {% csrf_token %}
                <div class="input-group mb-3">
                    <input type="search" name="query" class="form-control" placeholder="search for product" aria-label="Recipient's username"
                        aria-describedby="button-addon2">
                    <button class="btn btn-success" type="submit">Search</button>
    
                </div>

            </form>
        </div>
        <div class="row justify-content-center mt-5">

            {% for product in products %}
    
            <div class="col-lg-4">
                <div class="card">
                    <span class="badge bg-success m-3">{{product.category.name}}</span>
                    <h6>{{product.name}}</h6>
                    <p>KSH.{{product.price}}</p>
                    <div class="card-body">
                        <img class="img-fluid" src="{{product.image.url}}">
                        <small>{{product.description | truncatewords:10}}</small>
                        <button data-product="{{product.id}}" data-action="add" class="btn btn-success update-cart">Add to Cart</button>
                    </div>
                </div>
            </div>
    
            {% endfor %}
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}

<script>
var updateBtns = document.getElementByClassName(update-cart)

for(var i = 0; i < updateBtns.length; i++){
    updateBtns[i].addEventListener('click', function(){
        var productId = this.dataset.product
        var action = this.dataset.action
        console.log('product.id', product.id, 'action', action)
    })
}   
</script>

{% endblock %}